<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Predict - CP499</title>

    <link rel="stylesheet" href="../static/styles/style1.css" />
    <link rel="icon" href="../static/images/SWU.ico" />

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
    />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@500&display=swap"
      rel="stylesheet"
    />
  </head>

  <body>
    <!-- Navbar Start -->
    {% include 'components/navbar.html' %}
    <!-- Navbar End -->

    <!-- Section Upload & Train Start -->
    <section class="book" id="upload">
      <h2>Predict using Model</h2>

      <<form method="POST">
        {% for col in columns %}
          <label>{{ col }}:</label>
          {% if col in cat_values %}
            <select name="{{ col }}" required>
              {% for val in cat_values[col] %}
                <option value="{{ val }}">{{ val }}</option>
              {% endfor %}
            </select>
          {% else %}
            <input type="text" name="{{ col }}" required>
          {% endif %}
          <br>
        {% endfor %}
      
        <button type="submit">Predict</button>
      
        <!-- ✅ ปุ่มดาวน์โหลดโมเดล -->
        <a href="{{ url_for('download_catboost_model', filename='catboost_trained_' + model_id + '.pkl') }}"
           class="btn btn-secondary" style="margin-left: 10px;">
          Download Model
        </a>
      </form>
      
      {% if result is defined %}
        <h3>Prediction Result: Cluster {{ result }}</h3>
      {% endif %}
      
      {% if cluster_info %}
        <h3>Cluster Explanation:</h3>
        <ul>
          {% for cluster in cluster_info.clusters %}
            <li>
              <strong>{{ cluster.cluster }} - {{ cluster.group_name }}</strong>: {{ cluster.description }}
              <ul>
                {% for crit in cluster.criteria %}
                  <li>{{ crit }}</li>
                {% endfor %}
              </ul>
            </li>
          {% endfor %}
        </ul>
      {% endif %}
      
      
    </section>
    <!-- Section Upload & Train End -->

    <!-- Footer -->
    {% include 'components/footer.html' %}

    <!-- Bootstrap JS -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
